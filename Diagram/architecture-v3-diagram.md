# PhantomWall Cloud Threat Platform - Architecture v3

## ğŸ—ï¸ Complete System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    USER LAYER                                        â”‚
â”‚                                                                                      â”‚
â”‚                            ğŸ‘¤ End Users (Web Browser)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ HTTPS
                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              FRONTEND - AWS AMPLIFY                                  â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  React + Vite Application                                                     â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ Dashboard.jsx          (Real-time Threat Dashboard)                      â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ AlertsPage.jsx         (Alert Management & Filtering)                    â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ ChatAssistant.jsx      (AI-Powered Threat Analysis)                      â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ SecurityCharts.jsx     (Attack Visualization)                            â”‚  â”‚
â”‚  â”‚  â””â”€â”€ AttackTimeline.jsx     (Temporal Analysis)                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                      â”‚
â”‚  IAM Role: amplify_console                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ REST API (HTTPS + CORS)
                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          API GATEWAY (HTTP API)                                      â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Endpoints:                                                                  â”‚   â”‚
â”‚  â”‚  â€¢ GET  /events              â†’ Suricata API Lambda                           â”‚   â”‚
â”‚  â”‚  â€¢ POST /chat                â†’ Chat Assistant Lambda                         â”‚   â”‚
â”‚  â”‚  â€¢ GET  /alerts              â†’ Alert API Lambda (future)                     â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  Stage: prod (auto-deploy enabled)                                           â”‚   â”‚
â”‚  â”‚  CORS: Enabled for Amplify origin                                            â”‚   â”‚
â”‚  â”‚  Logging: CloudWatch Logs (request/response tracking)                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                     â”‚                    â”‚
             â”‚                     â”‚                    â”‚
             â–¼                     â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         COMPUTE LAYER - AWS LAMBDA                                   â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Suricata API     â”‚  â”‚ Chat Assistant   â”‚  â”‚ Suricata Ingest  â”‚  â”‚   Alert     â”‚ â”‚
â”‚  â”‚   Lambda         â”‚  â”‚     Lambda       â”‚  â”‚     Lambda       â”‚  â”‚  Indexer    â”‚ â”‚
â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚   Lambda    â”‚ â”‚
â”‚  â”‚ â€¢ Python 3.11    â”‚  â”‚ â€¢ Python 3.11    â”‚  â”‚ â€¢ Python 3.11    â”‚  â”‚             â”‚ â”‚
â”‚  â”‚ â€¢ 256 MB         â”‚  â”‚ â€¢ 512 MB         â”‚  â”‚ â€¢ 512 MB         â”‚  â”‚ â€¢ 256 MB    â”‚ â”‚
â”‚  â”‚ â€¢ 45s timeout    â”‚  â”‚ â€¢ 30s timeout    â”‚  â”‚ â€¢ 30s timeout    â”‚  â”‚             â”‚ â”‚
â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚             â”‚ â”‚
â”‚  â”‚ Queries:         â”‚  â”‚ Features:        â”‚  â”‚ Processes:       â”‚  â”‚ Indexes:    â”‚ â”‚
â”‚  â”‚ â€¢ Event history  â”‚  â”‚ â€¢ Bedrock AI     â”‚  â”‚ â€¢ CW Log events  â”‚  â”‚ â€¢ Fast      â”‚ â”‚
â”‚  â”‚ â€¢ Date ranges    â”‚  â”‚ â€¢ Threat context â”‚  â”‚ â€¢ JSON parsing   â”‚  â”‚   lookups   â”‚ â”‚
â”‚  â”‚ â€¢ Filtering      â”‚  â”‚ â€¢ Analysis       â”‚  â”‚ â€¢ Batch writes   â”‚  â”‚ â€¢ GSIs      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚           â”‚                     â”‚                      â”‚                   â”‚        â”‚
â”‚           â”‚ IAM: lambda_api     â”‚ IAM: lambda_chat     â”‚ IAM: lambda_ingestâ”‚        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                     â”‚                      â”‚                   â”‚
            â”‚ Query               â”‚ Query + InvokeModel  â”‚ Write             â”‚ Write
            â–¼                     â–¼                      â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DATA LAYER - DYNAMODB & BEDROCK                                 â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Suricata Events Table         â”‚     â”‚  PhantomWall Alerts Table              â”‚ â”‚
â”‚  â”‚                                â”‚     â”‚                                        â”‚ â”‚
â”‚  â”‚  â€¢ PK: event_date (YYYY-MM-DD) â”‚     â”‚  â€¢ PK: Composite key                   â”‚ â”‚
â”‚  â”‚  â€¢ SK: event_id (UUID)         â”‚     â”‚  â€¢ SK: timestamp                       â”‚ â”‚
â”‚  â”‚  â€¢ Billing: Pay-per-request    â”‚     â”‚  â€¢ GSI: src_ip-index                   â”‚ â”‚
â”‚  â”‚  â€¢ Retention: 30 days          â”‚     â”‚  â€¢ GSI: signature-index                â”‚ â”‚
â”‚  â”‚                                â”‚     â”‚  â€¢ TTL: 30 days (auto-cleanup)         â”‚ â”‚
â”‚  â”‚  Stores:                       â”‚     â”‚  â€¢ Billing: Pay-per-request            â”‚ â”‚
â”‚  â”‚  - Alert signatures            â”‚     â”‚                                        â”‚ â”‚
â”‚  â”‚  - Source/Dest IPs             â”‚     â”‚  Optimized for:                        â”‚ â”‚
â”‚  â”‚  - Attack metadata             â”‚     â”‚  - Fast IP lookups (10-50ms)           â”‚ â”‚
â”‚  â”‚  - Suricata event types        â”‚     â”‚  - Signature queries                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  AWS Bedrock (AI/ML)                                                         â”‚   â”‚
â”‚  â”‚  â€¢ Model: Configurable LLM                                                   â”‚   â”‚
â”‚  â”‚  â€¢ Use: Threat analysis, pattern detection, natural language queries        â”‚   â”‚
â”‚  â”‚  â€¢ Integration: Chat Assistant Lambda                                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â–²
                                       â”‚ Log Stream
                                       â”‚ (CloudWatch Logs Subscription)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       LOGGING & MONITORING - CLOUDWATCH                              â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Log Groups:                                                                 â”‚   â”‚
â”‚  â”‚  â€¢ /honeypot/suricata          (Suricata eve.json events)                    â”‚   â”‚
â”‚  â”‚  â€¢ /honeypot/bootstrap         (Instance setup logs)                         â”‚   â”‚
â”‚  â”‚  â€¢ /aws/lambda/...             (Lambda execution logs)                       â”‚   â”‚
â”‚  â”‚  â€¢ /aws/apigateway/...         (API Gateway access logs)                     â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  Retention: 14-30 days                                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  CloudWatch Agent                                                            â”‚   â”‚
â”‚  â”‚  â€¢ Installed on honeypot EC2                                                 â”‚   â”‚
â”‚  â”‚  â€¢ Streams Suricata logs in real-time                                        â”‚   â”‚
â”‚  â”‚  â€¢ System metrics collection                                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â–²
                                       â”‚ Logs & Metrics
                                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      HONEYPOT INFRASTRUCTURE - EC2                                   â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  EC2 Honeypot Instance                                                       â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  â€¢ AMI: Ubuntu 22.04 LTS (Jammy)                                             â”‚   â”‚
â”‚  â”‚  â€¢ Type: t3a.medium (2 vCPU, 4 GB RAM)                                       â”‚   â”‚
â”‚  â”‚  â€¢ Public IP: Auto-assigned                                                  â”‚   â”‚
â”‚  â”‚  â€¢ Subnet: Public (Internet Gateway attached)                                â”‚   â”‚
â”‚  â”‚  â€¢ IAM Role: EC2 CloudWatch access                                           â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚  Suricata IDS                                                         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Version: Latest stable                                             â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Ruleset: Full ET Open rules + Emerging Threats                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Output: eve.json (JSON format)                                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Detection modes: IDS + IPS capable                                 â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Network interfaces: Monitored                                      â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  User Data Bootstrap:                                                         â”‚   â”‚
â”‚  â”‚  1. Install Suricata + CloudWatch Agent                                      â”‚   â”‚
â”‚  â”‚  2. Configure Suricata rules                                                 â”‚   â”‚
â”‚  â”‚  3. Setup eve.json logging                                                   â”‚   â”‚
â”‚  â”‚  4. Start services                                                            â”‚   â”‚
â”‚  â”‚  5. Report bootstrap status to CloudWatch                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Security Group: honeypot-sg                                                 â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  Inbound Rules (Intentionally Permissive for Threat Detection):              â”‚   â”‚
â”‚  â”‚  â€¢ Port 22 (SSH)    from 0.0.0.0/0   - Attracts SSH brute force attacks     â”‚   â”‚
â”‚  â”‚  â€¢ Port 80 (HTTP)   from 0.0.0.0/0   - Attracts web scanning                â”‚   â”‚
â”‚  â”‚  â€¢ ICMP            from 0.0.0.0/0   - Network discovery detection           â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  Outbound Rules:                                                              â”‚   â”‚
â”‚  â”‚  â€¢ All traffic     to 0.0.0.0/0     - CloudWatch logging + updates          â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  âš ï¸  Note: Production deployments should implement auto-blocking             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ Scripts & Configs
                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            STORAGE - S3                                              â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Honeypot Scripts Bucket                                                     â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  Contents:                                                                    â”‚   â”‚
â”‚  â”‚  â€¢ honeypot_user_data.sh         - Main bootstrap script                     â”‚   â”‚
â”‚  â”‚  â€¢ honeypot_cloudwatch_agent.sh  - CloudWatch setup                          â”‚   â”‚
â”‚  â”‚  â€¢ honeypot_simple_wrapper.sh    - Wrapper scripts                           â”‚   â”‚
â”‚  â”‚  â€¢ Suricata configuration files                                              â”‚   â”‚
â”‚  â”‚                                                                               â”‚   â”‚
â”‚  â”‚  Access: EC2 IAM role can read                                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       SECURITY & IAM                                                 â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ IAM Role:            â”‚  â”‚ IAM Role:            â”‚  â”‚ IAM Role:            â”‚      â”‚
â”‚  â”‚ amplify_console      â”‚  â”‚ lambda_*             â”‚  â”‚ ec2_cloudwatch       â”‚      â”‚
â”‚  â”‚                      â”‚  â”‚                      â”‚  â”‚                      â”‚      â”‚
â”‚  â”‚ Permissions:         â”‚  â”‚ Permissions:         â”‚  â”‚ Permissions:         â”‚      â”‚
â”‚  â”‚ â€¢ CloudWatch Logs    â”‚  â”‚ â€¢ DynamoDB           â”‚  â”‚ â€¢ CloudWatch Logs    â”‚      â”‚
â”‚  â”‚ â€¢ S3 (builds)        â”‚  â”‚ â€¢ CloudWatch Logs    â”‚  â”‚ â€¢ S3 (scripts)       â”‚      â”‚
â”‚  â”‚                      â”‚  â”‚ â€¢ Bedrock (chat)     â”‚  â”‚                      â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  IAM Access Analyzer                                                         â”‚   â”‚
â”‚  â”‚  â€¢ Type: Account-level analyzer                                              â”‚   â”‚
â”‚  â”‚  â€¢ Monitors: External access to resources                                    â”‚   â”‚
â”‚  â”‚  â€¢ Alerts: Cross-account access patterns                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       OPTIONAL COMPONENTS                                            â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Kali Linux EC2 (Penetration Testing)                                        â”‚   â”‚
â”‚  â”‚  â€¢ Used for testing honeypot detection capabilities                          â”‚   â”‚
â”‚  â”‚  â€¢ Isolated in separate security group                                       â”‚   â”‚
â”‚  â”‚  â€¢ Optional: Only deployed when var.enable_kali = true                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Data Flow - Attack Detection Pipeline

```
1. ATTACK DETECTED
   ğŸ¯ Attacker
      â”‚
      â”‚ Malicious traffic (SSH brute force, web scan, etc.)
      â–¼
   ğŸ¯ Honeypot EC2 (Public IP, intentionally exposed)
      â”‚
      â”‚ Network packets
      â–¼
   ğŸ” Suricata IDS (Deep packet inspection + ruleset matching)
      â”‚
      â”‚ Generates eve.json events
      â–¼
   ğŸ“ Local file: /var/log/suricata/eve.json
      â”‚
      â”‚
      â–¼

2. LOG STREAMING
   â˜ï¸ CloudWatch Agent
      â”‚
      â”‚ Real-time streaming
      â–¼
   ğŸ“Š CloudWatch Logs (/honeypot/suricata)
      â”‚
      â”œâ”€â”€â”€ Subscription Filter (alerts only)
      â”‚    â”‚
      â”‚    â”‚ Triggers on pattern match
      â”‚    â–¼
      â”‚    âš¡ Suricata Ingest Lambda
      â”‚    â”‚
      â”‚    â”‚ Parse + Transform JSON
      â”‚    â–¼
      â”‚    ğŸ’¾ DynamoDB (Suricata Events Table)
      â”‚         - PK: event_date
      â”‚         - SK: event_id
      â”‚         - Attributes: src_ip, dest_ip, signature, etc.
      â”‚
      â””â”€â”€â”€ Secondary Filter (high-priority alerts)
           â”‚
           â”‚ Triggers on severity match
           â–¼
           âš¡ Alert Indexer Lambda
           â”‚
           â”‚ Extract + Index
           â–¼
           ğŸ’¾ DynamoDB (Alerts Table)
                - Fast GSI queries
                - src_ip-index
                - signature-index
                - TTL: 30 days

3. USER QUERY
   ğŸ‘¤ User (opens dashboard)
      â”‚
      â”‚ HTTPS
      â–¼
   ğŸŒ AWS Amplify (serves React app)
      â”‚
      â”‚ Browser loads, makes API call
      â–¼
   ğŸšª API Gateway (/events endpoint)
      â”‚
      â”‚ Invoke
      â–¼
   âš¡ Suricata API Lambda
      â”‚
      â”‚ Query DynamoDB with date range + filters
      â–¼
   ğŸ’¾ DynamoDB (Suricata Events)
      â”‚
      â”‚ Returns results (10-50ms)
      â–¼
   ğŸ“Š Dashboard (displays charts, tables, timeline)

4. AI ASSISTANT QUERY
   ğŸ‘¤ User: "What are the top attack sources?"
      â”‚
      â–¼
   ğŸ’¬ Chat UI (ChatAssistant.jsx)
      â”‚
      â”‚ POST /chat
      â–¼
   ğŸšª API Gateway
      â”‚
      â–¼
   âš¡ Chat Assistant Lambda
      â”‚
      â”œâ”€â”€â”€ Query recent events
      â”‚    â–¼
      â”‚    ğŸ’¾ DynamoDB
      â”‚    â”‚
      â”‚    â”‚ Returns context data
      â”‚    â–¼
      â””â”€â”€â”€ Build prompt with context
           â”‚
           â–¼
           ğŸ¤– AWS Bedrock (LLM)
           â”‚
           â”‚ InvokeModel
           â–¼
           ğŸ“ AI Analysis: "Top 5 attacking IPs: 1.2.3.4 (23 attempts), ..."
           â”‚
           â–¼
           ğŸ’¬ Display in chat interface
```

## ğŸ’° Cost Breakdown (Estimated Monthly)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Component                        Cost (1000 events/day)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  EC2 (t3a.medium, 24/7)           ~$30.00                        â”‚
â”‚  DynamoDB (Suricata Events)       ~$1.50                         â”‚
â”‚  DynamoDB (Alerts)                ~$0.75                         â”‚
â”‚  Lambda (all functions)           ~$0.50                         â”‚
â”‚  API Gateway                      ~$0.25                         â”‚
â”‚  CloudWatch Logs (30 day retain)  ~$2.00                         â”‚
â”‚  Data Transfer (egress)           ~$1.00                         â”‚
â”‚  AWS Amplify                      ~$0.00 (free tier)             â”‚
â”‚  Bedrock (100 queries/day)        ~$5.00                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  TOTAL:                           ~$41.00/month                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ’¡ Cost Optimization Tips:
   â€¢ Use t3a.small instead of medium: Save ~$15/month
   â€¢ Stop EC2 during off-hours: Save ~$20/month
   â€¢ Reduce log retention to 7 days: Save ~$1/month
   â€¢ Use DynamoDB on-demand: Only pay for what you use
```

## ğŸš€ Deployment Architecture

```
Terraform Workspaces:
â”œâ”€â”€ dev/
â”‚   â”œâ”€â”€ terraform.tfstate
â”‚   â””â”€â”€ Resources tagged: Env=dev
â”‚
â””â”€â”€ prod/
    â”œâ”€â”€ terraform.tfstate
    â””â”€â”€ Resources tagged: Env=prod

Infrastructure Files:
â”œâ”€â”€ main.tf                    # Provider & baseline config
â”œâ”€â”€ provider.tf                # AWS provider setup
â”œâ”€â”€ variables.tf               # Input variables
â”œâ”€â”€ locals.tf                  # Local variables & naming
â”œâ”€â”€ outputs.tf                 # Output values
â”‚
â”œâ”€â”€ honeypot_ec2.tf           # Honeypot EC2 + security group
â”œâ”€â”€ api_gateway.tf            # API Gateway + integrations
â”œâ”€â”€ logging_lambda.tf         # Suricata ingest Lambda + DynamoDB
â”œâ”€â”€ bedrock_chat.tf           # Chat assistant Lambda
â”œâ”€â”€ alerts-dynamodb.tf        # Fast alert indexing
â”œâ”€â”€ amplify_app.tf            # Frontend Amplify app
â”œâ”€â”€ amplify_iam.tf            # Amplify IAM roles
â”œâ”€â”€ security.tf               # IAM Access Analyzer
â”‚
â””â”€â”€ lambda/
    â”œâ”€â”€ suricata_ingest/      # Event processing
    â”œâ”€â”€ suricata_api/         # API queries
    â”œâ”€â”€ chat_assistant/       # AI integration
    â””â”€â”€ alert-indexer.py      # Alert indexing
```

## ğŸ¯ Key Features

âœ… **Real-time Threat Detection** - Suricata IDS with full ET ruleset  
âœ… **Scalable Storage** - DynamoDB pay-per-request billing  
âœ… **Fast Queries** - Sub-50ms alert lookups with GSI  
âœ… **AI Analysis** - AWS Bedrock for natural language threat insights  
âœ… **Modern Frontend** - React dashboard with real-time updates  
âœ… **Serverless** - Lambda functions, no servers to manage  
âœ… **Multi-environment** - Terraform workspaces (dev/prod)  
âœ… **Cost-effective** - ~$40/month for full stack  
âœ… **Fully Reversible** - Terraform destroy for complete cleanup  

## ğŸ”’ Security Best Practices

ğŸ›¡ï¸ **IAM Least Privilege** - Each role has minimal permissions  
ğŸ›¡ï¸ **No Hardcoded Secrets** - Environment variables + AWS Secrets Manager  
ğŸ›¡ï¸ **CloudWatch Encryption** - Logs encrypted at rest  
ğŸ›¡ï¸ **API CORS** - Restricted to Amplify origin  
ğŸ›¡ï¸ **Access Analyzer** - Monitors for external access  
ğŸ›¡ï¸ **TTL on Alerts** - Automatic 30-day cleanup  
ğŸ›¡ï¸ **Security Groups** - Minimal outbound, controlled inbound  
